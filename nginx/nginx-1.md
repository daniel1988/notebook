# Web服务器设计中的关键约束

## 1、性能

    性能是Nginx的根本，如果性能无法超越Apache，那么它也就没有存在的意义。这里所说的性能主体是web服务器，因此，
性能这个概念主要是从网终角度出发的，包含以下3个概念：

* 网络性能

        这里的网络性能是指在不同负载下，web服务器在网络通信上的吞吐量。网络性能一般会受于带宽（指特定的网络连接上可以达到
    的最大吞吐量）也就是更多受制于web服务的软件架构。
        大多数场景下，随着服务器上并发连接数的增加，网络性能都会有所下降。目前，我们在谈网络性能时，更多的是对应于高并发场景
    如：几万或者几十万并发连接下，要求我们的服务器仍然可以保持较高的网络吞吐量，而不是当并发连接数达到一定数据时，服务器的cpu等资源
    大都浪费在进程间切换、休眠、等待等其他活动上，导致吞吐量大幅下降。

* 单次请求延迟性

        单次请求的延迟性与上面说的网络性能的差别很明显，这里只是针对一个用户而言的。对于web服务器，延迟性就是指服务器初次
    接收到一个请求直到返回响应之间持续的时间。

        服务器在低并发和高并发连接数据量下，单个请求的平均延迟时间肯定是不同的，nginx在设计时更应该考虑的是高并发下如何
    保持平均时延迟性，使其不要上升得太快。

* 网络效率

        网络效率很好理解，就是使用网络的效率。如：长连接（keepalive）代替短连接以减少建立、关闭连接带来的网络交互，使用压缩
    算法来增加相同吞吐量下的信息携带量，使用缓存来减少网络交互次数等，它们都可以提高网络效率。

## 2、可伸缩性

    可伸缩性指架构可以通过添加组件来提升服务，或者允许组件之间具有交互功能。一般可以通过简化组件、降低组件间的耦合度、将服务
分散到许多组件等方法来改善可伸缩性。可伸缩性受到组件间的交互频率，以及组件对一个请求是使用同步还是异步的文式来处理等条件制约

## 3、简单性

    简单性通常指组件的简单程度，每个组件越简单，就会越容易理解和实现，也就越容易被验证。一般我们通过分享关注点原则来设计组件
对于整体架构来说，通常使用通用性原则，统一组件的接口，这样就减少了架构中的变数。

## 4、可修改性

    简单来讲，可修改性就是在当前架构下对于系统功能做出修改的难易程序，对于web服务器来说，它还包括动态的可修改性，也就是部署好
web服务器后，可以在不停止、不重启服务的前提下，提供给用户不同的、符合需求的功能。可修改性可以进一步分解为：可进化性、可拓展性
可配置性、和可重用性。

## 5、可见性

    在web服务器这个应用场景中，可见性通常是指一些关键组件的运行情况可以被监控的程度。例如，服务中正在交互的网络连接数、缓存
使用情况等。通过这种监控，可以改善服务的性能，尤其是可靠性。

## 6、可移植性

    可移植性是指服务可以跨平台运行

## 7、可靠性

    可靠性可以看做在服务出现部分故障时，一个架构容易受到系统层面故障影响的程度。可以通过以下方法提高可靠性：避免单点故障、
增加冗余、允许监视，以及用可恢复的动作来缩小故障的范围。
















